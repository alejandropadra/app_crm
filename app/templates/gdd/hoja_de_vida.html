{% extends 'layout.html' %}
{% from 'helpers/_forms.html' import render_field %}
{% block estilos %}

<link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" />
<link rel="stylesheet" href="{{ url_for('static', filename = 'css/estilos_tabla.css') }}">

{% endblock%}
{% block body %}

            <!-----------------------------------------Main------------------------------------------------>
<input type="hidden" id="indicador" value={{ficha_del_dueño_del_indicador}}> 
<input type="hidden" id="fichaCurrentUser" value={{ficha}}>
<input type="hidden" id="statusIndicador" value={{estado}} >

                
<div class="flex w-full justify-start my-7 mx-7 items-center gap-3">

    <a onclick="window.history.back()"  class="tarjeta-base h-4 w-4 flex justify-center items-center cursor-pointer bg-[--azul-dark] !transform-none hover:bg-slate-300 transition-all ease-out duration-100 ">
        <span class="material-symbols-rounded text-white">
            arrow_back
            </span>
    </a>
    <h3>Desempeño / Indicadores/</h3> <h3 class=" text-[--coral]"> Hoja de Vida</h3>
</div>
<form method="POST" id="formulario">
    {{ form.hidden_tag() }}
<div class="flex items-center w-100 justify-center">
    <div class="bg-[#fff] w-[90%] p-5 rounded-[18px] tarjeta-base">
        <div class="" >
            <h5 class="text-base font-semibold mb-2.5" >Hoja de Vida de Indicador : <i class=" font-normal" >{{nombre_indicador}}</i>  </h5>

        </div>
        {% if info_indicador == 'Vacio' %}
        <div class="grid grid-cols-2 gap-0.5">
            <div class="flex flex-col mb-10 w-100 gap-4 border-r border-solid p-3">

                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="vigencia">
                    <label for="Vigencia" class="mb-1">Vigencia</label>
                    <div class="flex it">
                        {{ render_field(form.vigencia_inicio, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="Vigencia") }}
                        {{ render_field(form.vigencia_fin, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="Vigencia") }}
                    </div>
                </div>

                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="fuente">
                    <label for="Generacion" class="mb-1">Fuente de información de datos</label>
                    {{ render_field(form.nivel_generacion ,class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="Generacion") }}
                </div>

                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="relacion">
                    <label for="Utilizacion" class="mb-1">Relación del indicador</label>
                    {{ render_field(form.nivel_util, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="Utilizacion") }}
                </div>

                
                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="medida">
                    <label for="Medida" class="mb-1">Unidad de Medida</label>
                    {{ render_field(form.unidad_medida, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="UM") }}
                </div>


                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="tipoindicador">
                    <label for="Naturaleza" class="mb-1">Tipo de Indicador </label>
                    <div id="listaTipoIndicador" 
                        class="flex flex-wrap items-start gap-2 max-w-full max-h-64 overflow-y-auto p-2 border border-gray-300 rounded-lg">
                    </div>
                    {{ render_field(form.tipo_indicador, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="TipoIndicador") }}
                </div>


            </div>

            <div class="flex flex-col w-100 mb-10 p-3">
                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="definicion">
                    <label for="Definicion" class="mb-2">Definición </label>
                    {{ render_field(form.definicion, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="Definicion") }}
                </div>

                
                <div class="form-group flex flex-col gap-0.5 mb-4 w-100" id="calculo">
                    <label for="FormaCalculo" class="mb-1">Forma de Cálculo </label>
                    {{ render_field(form.calculo, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900",   id="Calculo") }}
                </div>
            
            </div>



        </div>
        {% else %}
            <div class="grid grid-cols-2 gap-0.5">
                <div class="flex flex-col mb-10 w-100 gap-4 border-r border-solid p-3">

                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="Vigencia" class="mb-1">Vigencia</label>
                        <div class="flex it">
                            {{ render_field(form.vigencia_inicio, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="Vigencia", type = "date", value = info_indicador.vigencia_inicio) }}
                            {{ render_field(form.vigencia_fin, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="Vigencia", type = "date", value = info_indicador.vigencia_fin) }}
                        </div>
                    </div>

                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="Generacion" class="mb-1">Fuente de información de datos</label>
                        {{ render_field(form.nivel_generacion, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="Generacion", value = info_indicador.nivel_generacion) }}
                    </div>

                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="Utilizacion" class="mb-1">Relación del indicador</label>
                        {{ render_field(form.nivel_util, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="Utilizacion", value = info_indicador.nivel_util) }}
                    </div>

                    
                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="Medida" class="mb-1">Unidad de Medida</label>
                        {{ render_field(form.unidad_medida, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="UM", value = info_indicador.unidad_medida) }}
                    </div>

                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="Naturaleza" class="mb-1">Tipo de Indicador </label>
                            <div id="listaTipoIndicador" class="flex flex-wrap items-start gap-2 max-w-full max-h-64 overflow-y-auto p-2 border border-gray-300 rounded-lg">
                                {% for tipo in Tipo_indicador %}
                                <div class="relative p-4 my-2 bg-gray-100 border border-gray-300 rounded-lg shadow-sm w-40">
                                    <span>{{ tipo }}</span>
                                    <input type="hidden" name="tipoIndicadores[]" value="{{ tipo }}">
                                    <button type="button" class="absolute top-1 right-1 text-red-500 hover:text-red-700 text-sm" onclick="this.parentElement.remove();">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-circle-x-icon lucide-circle-x"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>
                                    </button>
                                </div>
                                {% endfor %}
                        </div>
                        {{ render_field(form.tipo_indicador, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="TipoIndicador", value = info_indicador.naturaleza) }}
                    </div>
                </div>

                <div class="flex flex-col w-100 mb-10 p-3">
                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="Definicion" class="mb-2">Definición </label>
                        {{ render_field(form.definicion, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="Definicion") }}
                    </div>
                    <div class="form-group flex flex-col gap-0.5 mb-4 w-100">
                        <label for="FormaCalculo" class="mb-1">Forma de Cálculo </label>
                        {{ render_field(form.calculo, class="w-full p-3 rounded-md border border-gray-300 focus:outline-none focus:border-blue-900", id="Calculo") }}
                    </div>
                </div>
            </div>
            {% endif %}

        <div class="flex w-full justify-end items-center gap-3">
            <button type="submit" class=" mt-3 cursor-pointer text-zinc-200 flex gap-2 items-center bg-valor-azul px-4 py-2 rounded-lg font-medium text-sm hover:bg-azul-dark transition-all ease-in duration-200" id="enviar">
                Enviar
            </button>
        </div>
        

    </div>

</form>   
</div>

{% endblock %}

{% block js%}
<script src="{{ url_for('static', filename='js/hoja_vida.js') }}"></script>
{% endblock %}